<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Summer&#39;s Blog</title>
  
  <subtitle>找到你，就像在夏天的午后，你找到了你的那一抹阳光</subtitle>
  <link href="https://xyz-summer.github.io/atom.xml" rel="self"/>
  
  <link href="https://xyz-summer.github.io/"/>
  <updated>2024-07-25T15:27:29.926Z</updated>
  <id>https://xyz-summer.github.io/</id>
  
  <author>
    <name>XYZ</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Hello World</title>
    <link href="https://xyz-summer.github.io/posts/4a17b156.html"/>
    <id>https://xyz-summer.github.io/posts/4a17b156.html</id>
    <published>2024-07-27T08:46:38.208Z</published>
    <updated>2024-07-25T15:27:29.926Z</updated>
    
    <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start">Quick Start</h2><h3 id="Create-a-new-post">Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server">Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files">Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites">Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;Welcome to &lt;a href=&quot;https://hexo.io/&quot;&gt;Hexo&lt;/a&gt;! This is your very first post. Check &lt;a href=&quot;https://hexo.io/docs/&quot;&gt;documentation&lt;/a&gt; for</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>中国工业互联网安全大赛智能家电行业赛道选拔赛初赛</title>
    <link href="https://xyz-summer.github.io/posts/e3f85d4d.html"/>
    <id>https://xyz-summer.github.io/posts/e3f85d4d.html</id>
    <published>2024-07-18T02:07:45.000Z</published>
    <updated>2024-07-18T02:19:46.000Z</updated>
    
    <content type="html"><![CDATA[<h1>2024中国工业互联网安全大赛智能家电行 业赛道选拔赛初赛</h1><p>没啥好说的 傻逼赛制2小时，比赛结束就得交wp，这波被队友骂麻了，结束补一下wp，结束还有一小时，一下开两个题我是真绷不住啊，虽然是比较简单，但是被压力上了呜呜呜，我有罪我检讨。。。2/2</p><h2 id="0x01-程序逆向分析">0x01 程序逆向分析</h2><p>程序逻辑还是相当简单的</p><p><img src="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240715142830105-169571230.png" alt="image-20240715142828934"></p><p>直接跟一手sub_401AD5函数看加密逻辑就行，经典维吉尼亚加密说是</p><p><img src="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240715142935824-1197869913.png" alt="image-20240715142935319"></p><p>正常按照程序逻辑逆回去就好了</p><p>exp:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">src = <span class="string">&quot;kwam&#123;dGawkqBxuiBlIHNjY3JniCBeZXNzYWjl&#125;&quot;</span></span><br><span class="line">        </span><br><span class="line">key = <span class="string">&quot;flag&#123;thisiskey&#125;&quot;</span></span><br><span class="line">idx=<span class="number">0</span></span><br><span class="line">key_len = <span class="built_in">len</span>(key)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(src)):</span><br><span class="line">    <span class="keyword">if</span> idx==key_len:</span><br><span class="line">        idx=<span class="number">0</span></span><br><span class="line">    <span class="keyword">if</span> src[i]&gt;=<span class="string">&#x27;a&#x27;</span> <span class="keyword">and</span> src[i]&lt;=<span class="string">&#x27;z&#x27;</span>:</span><br><span class="line">        nb=((<span class="built_in">ord</span>(src[i])-<span class="number">97</span>)-(<span class="built_in">ord</span>(key[idx])-<span class="number">97</span>))%<span class="number">26</span>+<span class="number">97</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">chr</span>(nb),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        idx=idx-<span class="number">1</span></span><br><span class="line">        <span class="built_in">print</span>(src[i],end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    idx = idx+<span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#flag&#123;dGhpcyBpcyBhIHNlY3JldCBtZXNzYWdl&#125;</span></span><br></pre></td></tr></table></figure><h2 id="0x02-安卓逆向分析">0x02 安卓逆向分析</h2><p>越做越生气，早知道早点起来帮他们弄了，哭，好jb简单的题啊呜呜</p><p>jadx直接看了，先是一个check密码，密码逻辑直接给了，可以直接爆破</p><p><img src="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240715151223811-672221070.png" alt="image-20240715151222808"></p><p>上爆破脚本：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">table1 = [<span class="number">44</span>, <span class="number">66</span>, <span class="number">67</span>, <span class="number">77</span>, <span class="number">46</span>, <span class="number">43</span>, <span class="number">47</span>, <span class="number">71</span>, <span class="number">49</span>, <span class="number">68</span>, <span class="number">80</span>, <span class="number">50</span>, <span class="number">68</span>, <span class="number">83</span>, </span><br><span class="line">        <span class="number">51</span>, <span class="number">49</span>, <span class="number">50</span>, <span class="number">68</span>, <span class="number">58</span>, <span class="number">56</span>, <span class="number">61</span>, <span class="number">53</span>, <span class="number">70</span>, </span><br><span class="line">        <span class="number">57</span>, <span class="number">58</span>, <span class="number">79</span>, <span class="number">59</span>, <span class="number">78</span>, <span class="number">66</span>, <span class="number">67</span>, <span class="number">89</span>, <span class="number">68</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(table1)):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        temp = (j+table1[i])%<span class="number">101</span></span><br><span class="line">        temp = (temp * <span class="number">2</span>)-i</span><br><span class="line">        <span class="keyword">if</span>(temp==j):</span><br><span class="line">            <span class="built_in">print</span>(<span class="built_in">chr</span>(j),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#rGF3ryrCpK4qN1rwvShmduTonEnIba6a</span></span><br></pre></td></tr></table></figure><p>还有一层check是在native层的，常规把apk解包了看看so</p><p><img src="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240715151450689-87954753.png" alt="image-20240715151450155"></p><p>进来之后逻辑有提示了，说是RC4，然后直接找main，应该是sub_402414</p><p><img src="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240715151550805-257668870.png" alt="image-20240715151550228"></p><p>往里面一直跟之后就能找到用于check的密文，继续往里面跟，把密文拿出来就好了，没看见其他有密钥的地方，猜猜都知道，之前爆破出来的密码就是密钥</p><p><img src="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240715151704975-31955262.png" alt="image-20240715151704362"></p><p><img src="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240715151804261-596717053.png" alt="image-20240715151803807"></p><p>找个在线网站直接解了</p><p><img src="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240715151840964-1784673047.png" alt="image-20240715151840257"></p><p>最后直接login就好了</p><p><img src="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240715151906729-225076905.png" alt="image-20240715151906204"></p>]]></content>
    
    
    <summary type="html">中国工业互联网安全大赛智能家电行业赛道选拔赛初赛</summary>
    
    
    
    <category term="Writeup" scheme="https://xyz-summer.github.io/categories/Writeup/"/>
    
    
    <category term="CTF" scheme="https://xyz-summer.github.io/tags/CTF/"/>
    
  </entry>
  
</feed>
